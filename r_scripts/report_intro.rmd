---
title: "Sequencing Report"
output:
  pdf_document: default
date: "`r Sys.Date()`"
---

## Understanding your results
You have been given a download link to receive the following data:

### Raw sequence data
The sequencing files, in the form of paired-end fastq files generated as standard by the Illumina sequencing platform, can be found in the 'ITS2' and 'SSU' folders. 'ITS2' contains the data generated by sequencing an amplicon produced using primers that amplify the ITS2 region of the rDNA (SPUN uses ITS3/ITS4). 'SSU' contains the data generated by sequencing an amplicon produced using primers that amplify the SSU region of the rDNA (SPUN uses WANDA/AML2).

*Use this data for your own bioinformatics analyses if you do not want to use the Phyloseq object generated by SPUN's bioinformatics pipeline.*

### Quality metrics of raw sequence data

Inside the 'ITS2' and 'SSU' folders is a folder named 'MultiQC_report'. This contains a folder with a code name, and inside is a file called 'multiqc_report.html'. 

- Use this report to understand the quality of the raw sequence reads. The most important information is the 'Sequence Quality Histogram' that tells you the average quality score across each read in a sample. If you have failed samples, these may have been removed from the analysis, and if so, this will be listed in this document. The 'Sequence Duplication Levels' graph can be ignored, as this always fails in metabarcoding analyses.

### Phyloseq objects

You have been provided with [phyloseq](https://joey711.github.io/phyloseq/index.html) objects, these contain all information about the samples and their associated identified taxa. This was generated as a result of cleaning and filtering the sequence data, followed by clustering into OTUs (for ITS2 EcM data) or forming ASVs (for SSU AMF data). Use these to carry out analytics into the community composition of your samples within R.

There are multiple phyloseq objects that have been provided to you in the outputs folder.

- phyloseq_decontam.Rdata - A Phyloseq object that has had all contaminating OTUs or ASVs removed (using the R package decontam.R and your negative controls). You will have a phyloseq_decontam.R file inside each of your results folders, 'lotus2_ITS2' and 'lotus2_SSU_ASVs'. This phyloseq object contains all taxa (except contaminants) identified in your samples, including metazoan taxa, non-mycorrhizal fungal taxa, and more. *Use this if you are interested in analysing more than just mycorrhizal data, and would also like to look at saprotrophs and other fungi in addition to mycorrhizal fungi.*
- ecm_physeq.Rdata - A Phyloseq object that contains only EcM taxa. This was produced by using a modified version of the [FungalTraits database](https://link.springer.com/article/10.1007/s13225-020-00466-2) to remove any taxa from the ITS2 Phyloseq object that are not designated with ectomycorrhizal as their primary lifestyle. This Phyloseq object can be found inside 'lotus2_ITS2' inside your results folder. The script and database used to generate this can be found on the SPUN Github. *Use this if you are only interested in analysing ectomycorrhizal fungi from your ITS data.*
- amf_physeq.Rdata - A Phyloseq object that contains only AMF taxa. This was produced by removing any taxa from the SSU Phyloseq object that do not belong to one of the three classes of AMF taxa: Glomeromycetes, Archaeosporomycetes, and Paraglomeromycetes. This Phyloseq object can be found inside 'lotus2_SSU_ASVs' inside your results folder. The script and database used to generate this can be found on the SPUN Github. *Use this if you are only interested in analysing AMF from your SSU data.*
- phyloseq.Rdata - If for any reason you would like to see the initial phyloseq object produced by Lotus2 prior to the removal of likely contaminant OTUs or ASVs, this can be found in the outputs folder as well.

### Bioinformatics processing

The software [Lotus2](https://lotus2.earlham.ac.uk/) was used to designate OTUs from ITS2 sequences and ASVs from SSU sequences. Exact commands including parameters are listed below. Following generation of a [phyloseq](https://joey711.github.io/phyloseq/) object by Lotus2, OTUs or ASVs made up of a very low read count are filtered out, and the decontam program is run to remove contaminating OTUs or ASVs based on the included presence of which taxa are identified in the control samples. Full code and scripts can be found on SPUN's Github page.
